[phases.setup]
nixPkgs = ["maven", "jdk"]

[phases.build]
cmds = [
  "mvn clean compile package -DskipTests",
  "echo '=== Build Verification ==='",
  "echo 'Checking if EmbeddedTomcatServer was compiled:'",
  "find target/classes -name 'EmbeddedTomcatServer.class' && echo 'Found in target/classes' || echo 'Not in target/classes'",
  "echo 'Checking WAR contents:'",
  "jar tf target/sendGridBasicRailway.war | grep EmbeddedTomcatServer && echo 'Found in WAR' || echo 'Not in WAR'",
  "echo 'All classes in com/sendgrid:'",
  "jar tf target/sendGridBasicRailway.war | grep 'com/sendgrid/' | head -10"
]

[phases.start]
cmd = "sh railway-start.sh"

